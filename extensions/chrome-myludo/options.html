<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Assotheque - Configuration</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }
    .container {
      max-width: 600px;
      margin: 0 auto;
    }
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      padding: 30px;
      margin-bottom: 20px;
    }
    h1 {
      color: #333;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    h1 svg {
      width: 32px;
      height: 32px;
    }
    .subtitle {
      color: #666;
      margin-bottom: 30px;
    }
    .form-group {
      margin-bottom: 20px;
    }
    label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: #333;
    }
    input[type="text"],
    input[type="url"],
    input[type="password"] {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.2s;
    }
    input:focus {
      outline: none;
      border-color: #667eea;
    }
    .help-text {
      font-size: 12px;
      color: #888;
      margin-top: 5px;
    }
    .btn {
      display: inline-block;
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
    }
    .btn-secondary {
      background: #f0f0f0;
      color: #333;
      margin-left: 10px;
    }
    .btn-secondary:hover {
      background: #e0e0e0;
    }
    .status {
      padding: 12px 15px;
      border-radius: 8px;
      margin-top: 20px;
      font-size: 14px;
    }
    .status.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }
    .status.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }
    .api-key-info {
      background: #f8f9fa;
      border-left: 4px solid #667eea;
      padding: 15px;
      margin-top: 20px;
      border-radius: 0 8px 8px 0;
    }
    .api-key-info h3 {
      font-size: 14px;
      margin-bottom: 10px;
    }
    .api-key-info ol {
      font-size: 13px;
      padding-left: 20px;
      color: #555;
    }
    .api-key-info li {
      margin-bottom: 5px;
    }
    .connection-status {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
      margin-top: 20px;
    }
    .connection-status .dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
    }
    .connection-status .dot.connected {
      background: #28a745;
    }
    .connection-status .dot.disconnected {
      background: #dc3545;
    }
    .connection-status .dot.unknown {
      background: #ffc107;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>
        <svg viewBox="0 0 24 24" fill="none" stroke="#667eea" stroke-width="2">
          <circle cx="12" cy="12" r="3"/>
          <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
        </svg>
        Configuration Assotheque
      </h1>
      <p class="subtitle">Configurez la connexion a votre serveur Assotheque</p>

      <form id="configForm">
        <div class="form-group">
          <label for="serverUrl">URL du serveur</label>
          <input type="url" id="serverUrl" placeholder="https://votre-serveur.com" required>
          <p class="help-text">L'URL complete de votre installation Assotheque</p>
        </div>

        <div class="form-group">
          <label for="apiKey">Cle API</label>
          <input type="password" id="apiKey" placeholder="ask_xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx" required>
          <p class="help-text">La cle API generee depuis Parametres > Cles API</p>
        </div>

        <div>
          <button type="submit" class="btn btn-primary">Enregistrer</button>
          <button type="button" class="btn btn-secondary" onclick="testConnection()">Tester la connexion</button>
        </div>

        <div id="status" class="status" style="display: none;"></div>

        <div id="connectionStatus" class="connection-status" style="display: none;">
          <span class="dot unknown"></span>
          <span class="text">Non teste</span>
        </div>
      </form>

      <div class="api-key-info">
        <h3>Comment obtenir une cle API ?</h3>
        <ol>
          <li>Connectez-vous a votre interface d'administration Assotheque</li>
          <li>Allez dans <strong>Parametres > Services externes > Cles API</strong></li>
          <li>Cliquez sur <strong>Nouvelle Cle</strong></li>
          <li>Donnez un nom (ex: "Extension Chrome MyLudo")</li>
          <li>Cochez les permissions <strong>jeux:create</strong>, <strong>jeux:update</strong> et <strong>images:upload</strong></li>
          <li>Copiez la cle generee et collez-la ci-dessus</li>
        </ol>
      </div>
    </div>
  </div>

  <script src="options.js"></script>
</body>
</html>
